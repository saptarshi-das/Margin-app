import{a as Y,b as q}from"./vendor-react-U42-5PqJ.js";import{r as c,M as _,P as R,T as B,X as P,S as K,D as J,a as H,C as X,L as V,U as Q,b as Z,c as D,d as ee,e as te}from"./vendor-ui-ClUictcM.js";import{i as se,g as re,a as ae,e as ne,G as oe,o as ie,s as S,b as le,d as ce,c as de,f as xe,h as ue,T as he}from"./firebase-DVO_G2Qt.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();var e=Y(),N={},E;function ge(){if(E)return N;E=1;var n=q();return N.createRoot=n.createRoot,N.hydrateRoot=n.hydrateRoot,N}var me=ge();function be({courses:n,onUpdateLeaves:t,onDeleteCourse:i,isDark:a}){const[o,l]=c.useState(null),s=r=>{i(r),l(null)};return n.length===0?e.jsx("div",{className:`rounded-2xl shadow-md p-8 text-center ${a?"bg-gray-800":"bg-white"}`,children:e.jsx("p",{className:a?"text-gray-500":"text-gray-400",children:"No courses added yet. Add your first course!"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`rounded-2xl shadow-md p-5 ${a?"bg-gray-800":"bg-white"}`,children:[e.jsx("h2",{className:`mb-4 ${a?"text-white":"text-gray-800"}`,children:"My Courses"}),e.jsx("div",{className:"space-y-3",children:n.map(r=>{const g=r.leaves>r.maxLeaves;return e.jsxs("div",{className:`flex items-center gap-3 p-4 rounded-xl transition-colors ${g?"bg-red-500/90 hover:bg-red-600/90":a?"bg-gray-700 hover:bg-gray-600":"bg-gray-50 hover:bg-gray-100"}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`break-words ${g||a?"text-white":"text-gray-800"}`,children:r.name}),e.jsxs("p",{className:`text-sm ${g?"text-white/90":a?"text-gray-400":"text-gray-500"}`,children:[r.leaves," ",r.leaves===1?"leave":"leaves"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>t(r.id,-1),disabled:r.leaves===0,className:"p-2.5 rounded-lg bg-red-100 hover:bg-red-200 text-red-600 disabled:opacity-30 disabled:cursor-not-allowed transition-colors active:scale-95",children:e.jsx(_,{size:18})}),e.jsx("button",{onClick:()=>t(r.id,1),className:"p-2.5 rounded-lg bg-green-100 hover:bg-green-200 text-green-600 transition-colors active:scale-95",children:e.jsx(R,{size:18})}),e.jsx("button",{onClick:()=>l(r.id),className:`p-2.5 rounded-lg transition-colors active:scale-95 ${a?"bg-gray-600 hover:bg-gray-500 text-gray-300":"bg-gray-200 hover:bg-gray-300 text-gray-600"}`,children:e.jsx(B,{size:18})})]})]},r.id)})})]}),o&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:`rounded-2xl p-6 max-w-sm w-full shadow-xl ${a?"bg-gray-800":"bg-white"}`,children:[e.jsx("h3",{className:`mb-2 ${a?"text-white":"text-gray-800"}`,children:"Delete Course?"}),e.jsx("p",{className:`text-sm mb-6 ${a?"text-gray-400":"text-gray-600"}`,children:"Are you sure you want to delete this course? This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>l(null),className:`flex-1 py-2.5 rounded-lg transition-colors ${a?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800"}`,children:"Cancel"}),e.jsx("button",{onClick:()=>s(o),className:"flex-1 py-2.5 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",children:"Delete"})]})]})})]})}function pe({onAddCourse:n,isDark:t}){const[i,a]=c.useState(!1),[o,l]=c.useState(""),[s,r]=c.useState(""),[g,h]=c.useState("10"),d=x=>{x.preventDefault(),o.trim()&&g&&(n(o.trim(),s.trim(),parseInt(g)),l(""),r(""),h("10"),a(!1))};return i?e.jsxs("div",{className:`rounded-2xl shadow-md p-6 ${t?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:t?"text-white":"text-gray-800",children:"New Course"}),e.jsx("button",{onClick:()=>{a(!1),l(""),r(""),h("10")},className:`p-1 rounded-lg transition-colors ${t?"hover:bg-gray-700 text-gray-400":"hover:bg-gray-100 text-gray-500"}`,children:e.jsx(P,{size:20})})]}),e.jsxs("form",{onSubmit:d,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm mb-1.5 ${t?"text-gray-300":"text-gray-700"}`,children:"Course Name *"}),e.jsx("input",{type:"text",value:o,onChange:x=>l(x.target.value),placeholder:"e.g., Indian Economy and Marketing",autoFocus:!0,required:!0,className:`w-full px-4 py-2.5 rounded-xl border focus:outline-none focus:ring-2 focus:ring-[#e50914] ${t?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-200 text-gray-900 placeholder-gray-400"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm mb-1.5 ${t?"text-gray-300":"text-gray-700"}`,children:["Short Name ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("input",{type:"text",value:s,onChange:x=>r(x.target.value),placeholder:"e.g., FSAFA",className:`w-full px-4 py-2.5 rounded-xl border focus:outline-none focus:ring-2 focus:ring-[#e50914] ${t?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-200 text-gray-900 placeholder-gray-400"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm mb-1.5 ${t?"text-gray-300":"text-gray-700"}`,children:"Maximum Leaves Permitted *"}),e.jsx("input",{type:"number",value:g,onChange:x=>h(x.target.value),placeholder:"10",min:"1",required:!0,className:`w-full px-4 py-2.5 rounded-xl border focus:outline-none focus:ring-2 focus:ring-[#e50914] ${t?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-200 text-gray-900 placeholder-gray-400"}`})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>{a(!1),l(""),r(""),h("10")},className:`flex-1 px-4 py-2.5 rounded-xl transition-colors ${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800"}`,children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-[#e50914] hover:bg-[#b8070f] text-white px-4 py-2.5 rounded-xl transition-colors",children:"Add Course"})]})]})]}):e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>a(!0),className:`rounded-xl shadow-md px-5 py-2.5 flex items-center gap-2 transition-all ${t?"bg-gray-800 hover:bg-gray-700 text-white":"bg-white hover:bg-gray-50 text-gray-800"}`,children:[e.jsx(R,{size:18}),e.jsx("span",{children:"Add Course"})]})})}function fe({courses:n,isDark:t}){const i=n.length,a=n.reduce((s,r)=>s+r.leaves,0),o=i>0?(a/i).toFixed(1):"0",l=n.length>0?n.reduce((s,r)=>r.leaves>s.leaves?r:s,n[0]):null;return e.jsxs("div",{className:`rounded-2xl p-5 ${t?"bg-white shadow-lg":"bg-gradient-to-br from-gray-900 to-black"} shadow-lg`,children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-lg ${t?"text-gray-900":"text-white"}`,children:e.jsx("b",{children:"Dashboard"})}),e.jsx("p",{className:`text-sm ${t?"text-gray-600":"text-white/70"}`,children:"Your attendance overview"})]}),e.jsxs("div",{className:`px-3 py-1.5 rounded-full backdrop-blur-md border flex items-center gap-2 ${t?"bg-white/20 border-white/30":"bg-white/10 border-white/20"}`,children:[e.jsx("span",{className:`text-xs ${t?"text-gray-600":"text-white/70"}`,children:"Total Courses:"}),e.jsx("span",{className:`text-sm ${t?"text-gray-900":"text-white"}`,children:i})]})]}),n.length>0&&e.jsxs("div",{className:`rounded-xl p-4 mb-4 backdrop-blur-md border shadow-lg ${t?"bg-gray-800/80 border-gray-700/50 shadow-black/5":"bg-white/10 border-white/20 shadow-black/10"}`,children:[e.jsx("p",{className:`text-xs mb-3 ${t?"text-gray-600":"text-white/70"}`,children:"Recent Courses"}),e.jsx("div",{className:"space-y-3",children:n.map(s=>{const r=s.leaves>s.maxLeaves;return e.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-lg ${r?"bg-red-500/20":""}`,children:[e.jsx("span",{className:`text-sm min-w-[60px] ${r?"text-red-600 font-semibold":t?"text-gray-900":"text-white"}`,children:s.shortName||s.name}),r&&e.jsx(K,{size:14,className:"text-red-600 fill-red-600"}),e.jsx("div",{className:"flex gap-1 flex-1",children:Array.from({length:s.maxLeaves}).map((g,h)=>e.jsx("div",{className:`h-6 rounded-full flex-1 ${h<s.leaves?"bg-red-500":t?"bg-gray-300":"bg-white/40"}`},h))}),e.jsx("span",{className:`text-sm min-w-[20px] text-right ${r?"text-red-600 font-semibold":t?"text-gray-900":"text-white"}`,children:s.leaves})]},s.id)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:`rounded-xl p-3 backdrop-blur-md border shadow-lg ${t?"bg-gray-800/80 border-gray-700/50 shadow-black/5":"bg-white/15 border-white/20 shadow-black/10"}`,children:[e.jsx("p",{className:`text-xs mb-1 ${t?"text-gray-600":"text-white/70"}`,children:"Average"}),e.jsx("p",{className:`text-2xl ${t?"text-gray-900":"text-white"}`,children:o})]}),e.jsxs("div",{className:`rounded-xl p-3 backdrop-blur-md border shadow-lg ${t?"bg-gray-800/80 border-gray-700/50 shadow-black/5":"bg-white/15 border-white/20 shadow-black/10"}`,children:[e.jsx("p",{className:`text-xs mb-1 ${t?"text-gray-600":"text-white/70"}`,children:"Highest"}),e.jsx("p",{className:`text-2xl ${t?"text-gray-900":"text-white"}`,children:l?.leaves||0})]})]})]})}function ye({isDark:n}){const[t,i]=c.useState(null),[a,o]=c.useState(!1);c.useEffect(()=>{const s=r=>{r.preventDefault(),i(r),o(!0)};return window.addEventListener("beforeinstallprompt",s),()=>{window.removeEventListener("beforeinstallprompt",s)}},[]);const l=async()=>{if(!t)return;t.prompt();const{outcome:s}=await t.userChoice;i(null),o(!1)};return a?e.jsx("div",{className:`rounded-2xl shadow-lg p-4 mb-4 ${n?"bg-gradient-to-r from-blue-900 to-indigo-900":"bg-gradient-to-r from-blue-500 to-indigo-600"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(J,{className:"text-white mt-1",size:24}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white mb-1",children:"Add to Home Screen"}),e.jsx("p",{className:"text-white/80 text-sm",children:"Install this app on your device for quick access"}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:l,className:"bg-white text-blue-600 px-4 py-2 rounded-lg text-sm hover:bg-gray-100 transition-colors",children:"Install"}),e.jsx("button",{onClick:()=>o(!1),className:"text-white px-4 py-2 rounded-lg text-sm hover:bg-white/10 transition-colors",children:"Later"})]})]}),e.jsx("button",{onClick:()=>o(!1),className:"text-white/70 hover:text-white transition-colors",children:e.jsx(P,{size:20})})]})}):null}const we={apiKey:"AIzaSyAggnn8XaEhvxeOGPR-YSuqJKb1oTTnOyc",authDomain:"margin-e64b8.firebaseapp.com",projectId:"margin-e64b8",storageBucket:"margin-e64b8.firebasestorage.app",messagingSenderId:"531122372814",appId:"1:531122372814:web:2db6bce072da6980ac909f"},M=se(we),v=re(M),z=ae(M);setTimeout(()=>{ne(z).catch(n=>{n.code==="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Firestore persistence not supported in this browser")})},0);const T=new oe;T.setCustomParameters({prompt:"select_account",hd:"iimranchi.ac.in"});const F=c.createContext(void 0),L=()=>{const n=c.useContext(F);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},C="iimranchi.ac.in",ve=({children:n})=>{const[t,i]=c.useState(null),[a,o]=c.useState(!0),[l,s]=c.useState(null);c.useEffect(()=>{const d=ie(v,x=>{x?(x.email||"").split("@")[1]===C?(i(x),s(null)):(S(v),i(null),s(`Only ${C} email addresses are allowed.`)):i(null),o(!1)});return()=>d()},[]);const h={user:t,loading:a,signInWithGoogle:async()=>{try{if(s(null),((await le(v,T)).user.email||"").split("@")[1]!==C)throw await S(v),new Error(`Only ${C} email addresses are allowed.`)}catch(d){throw console.error("Sign in error:",d),d.code==="auth/popup-closed-by-user"?s("Sign in was cancelled."):d.code==="auth/popup-blocked"?s("Pop-up was blocked. Please allow pop-ups for this site."):s(d.message||"Failed to sign in with Google."),d}},signOut:async()=>{try{await S(v),s(null)}catch(d){throw console.error("Sign out error:",d),s("Failed to sign out."),d}},error:l};return e.jsx(F.Provider,{value:h,children:n})},je=({isDark:n})=>{const{signInWithGoogle:t,error:i,loading:a}=L(),o=async()=>{try{await t()}catch(l){console.error("Login failed:",l)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center transition-colors bg-gradient-to-br from-gray-900 via-gray-800 to-black",children:e.jsxs("div",{className:"w-full max-w-md mx-4",children:[e.jsxs("div",{className:"text-center mb-8 animate-fade-in",children:[e.jsx("div",{className:"inline-flex items-center justify-center mb-4",children:e.jsx("img",{src:"/icon-192.png",alt:"Margin Logo",className:"w-20 h-20 rounded-2xl shadow-2xl shadow-[#e50914]/50"})}),e.jsx("h1",{className:"text-4xl font-bold mb-2 text-white",children:e.jsx("b",{children:"Margin"})}),e.jsx("p",{className:"text-lg text-gray-300",children:"Maximise your Leaves"})]}),e.jsx("div",{className:"rounded-2xl p-8 backdrop-blur-xl transition-all duration-300 bg-white/10 border border-white/20 shadow-2xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2 text-white",children:"Welcome"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Sign in to access your leave tracker"})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-[#e50914]/20 border border-gray-600",children:[e.jsx(H,{className:"w-5 h-5 mt-0.5 flex-shrink-0 text-[#e50914]"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-white",children:"IIM Ranchi Students Only"}),e.jsx("p",{className:"text-xs text-gray-300",children:"Only iimranchi.ac.in email addresses are allowed"})]})]}),i&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl animate-shake bg-red-500/20 border border-red-400/30",children:[e.jsx(X,{className:"w-5 h-5 mt-0.5 flex-shrink-0 text-red-300"}),e.jsx("p",{className:"text-sm text-red-200",children:i})]}),e.jsx("button",{onClick:o,disabled:a,className:"w-full py-4 px-6 rounded-xl font-semibold flex items-center justify-center gap-3 transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none bg-[#e50914] text-white hover:bg-[#f40612] shadow-xl shadow-[#e50914]/30",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Signing in..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{children:"Sign in with Google"})]})}),e.jsx("p",{className:"text-xs text-center text-gray-400",children:"By signing in, you agree to use this app responsibly"})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-sm text-gray-400",children:"Track your course leaves efficiently so that you maximise leaves"})})]})})},Ne=({isDark:n})=>{const{user:t,signOut:i}=L(),[a,o]=c.useState(!1),l=c.useRef(null),s=c.useRef(null),[r,g]=c.useState({top:0,right:0});if(!t)return null;c.useEffect(()=>{const m=()=>{if(s.current){const b=s.current.getBoundingClientRect();g({top:b.bottom+8,right:b.left})}};return a&&(m(),window.addEventListener("resize",m),window.addEventListener("scroll",m)),()=>{window.removeEventListener("resize",m),window.removeEventListener("scroll",m)}},[a]),c.useEffect(()=>{const m=b=>{l.current&&!l.current.contains(b.target)&&s.current&&!s.current.contains(b.target)&&o(!1)};return a&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[a]);const h=async()=>{try{await i()}catch(m){console.error("Sign out failed:",m)}},d=240,x=s.current?.getBoundingClientRect(),w=x?x.right-d:0;return e.jsxs(e.Fragment,{children:[e.jsxs("button",{ref:s,onClick:()=>o(!a),className:`flex items-center gap-2 p-2 rounded-xl transition-all duration-200 ${n?"hover:bg-white/10":"hover:bg-gray-100"}`,children:[t.photoURL?e.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full ring-2 ring-white/20"}):e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-purple-600",children:e.jsx(Q,{className:"w-4 h-4 text-white"})}),e.jsx(Z,{className:`w-4 h-4 transition-transform ${a?"rotate-180":""} ${n?"text-gray-300":"text-gray-600"}`})]}),a&&e.jsxs("div",{ref:l,style:{position:"fixed",top:`${r.top}px`,left:`${w}px`},className:`w-60 rounded-xl shadow-2xl border z-[100] ${n?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:`p-4 border-b ${n?"border-gray-700":"border-gray-200"}`,children:[e.jsx("p",{className:`font-semibold mb-1 ${n?"text-white":"text-gray-900"}`,children:t.displayName||"User"}),e.jsx("p",{className:`text-sm break-words ${n?"text-gray-400":"text-gray-600"}`,children:t.email})]}),e.jsx("div",{className:"p-2",children:e.jsxs("button",{onClick:h,className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all duration-200 ${n?"hover:bg-red-500/20 text-red-400":"hover:bg-red-50 text-red-600"}`,children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Sign Out"})]})})]})]})},j=!1,Ce="userCourses",I="courses",A="lastSync";class Se{userId;unsubscribe=null;isOnline=navigator.onLine;constructor(t){this.userId=t,this.setupOnlineListener()}setupOnlineListener(){window.addEventListener("online",()=>{this.isOnline=!0,this.syncLocalToServer()}),window.addEventListener("offline",()=>{this.isOnline=!1})}getUserDocRef(){return ce(z,Ce,this.userId)}getLocalCourses(){try{const t=localStorage.getItem(I);return t?JSON.parse(t):[]}catch(t){return console.error("Error reading from localStorage:",t),[]}}saveLocalCourses(t){try{localStorage.setItem(I,JSON.stringify(t)),localStorage.setItem(A,Date.now().toString())}catch(i){console.error("Error saving to localStorage:",i)}}initialize(t){const i=this.getLocalCourses();return this.isOnline&&this.syncWithServer(i,t),i}async syncWithServer(t,i){try{const a=this.getUserDocRef(),o=await de(a);if(o.exists()){const l=o.data().courses||[],s=o.data().updatedAt?.toMillis()||0,r=parseInt(localStorage.getItem(A)||"0");s>=r?(this.saveLocalCourses(l),i(l)):await this.saveCourses(t)}else t.length>0&&await this.saveCourses(t);this.setupRealtimeListener(i)}catch(a){console.error("⚠️ Background sync failed (local data still works):",a)}}setupRealtimeListener(t){this.unsubscribe&&this.unsubscribe();const i=this.getUserDocRef();this.unsubscribe=xe(i,a=>{if(a.exists()){const o=a.data().courses||[];this.saveLocalCourses(o),t(o)}},a=>{console.error("Error in real-time listener:",a)})}async saveCourses(t){if(this.saveLocalCourses(t),!!this.isOnline)try{const i=this.getUserDocRef();await ue(i,{courses:t,updatedAt:he.now(),userId:this.userId})}catch(i){console.error("⚠️ Failed to save to server (saved locally):",i)}}async syncLocalToServer(){const t=this.getLocalCourses();if(t.length>0)try{await this.saveCourses(t)}catch{}}cleanup(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}}function Le(n){return new Se(n)}function $e(){const{user:n,loading:t}=L(),[i,a]=c.useState([]),[o,l]=c.useState(!1),s=c.useRef(null),[r,g]=c.useState(()=>localStorage.getItem("theme")==="dark");c.useEffect(()=>{if(n&&!s.current){const u=Le(n.uid);s.current=u;const p=u.initialize(a);a(p),l(!0)}else!n&&s.current&&(s.current.cleanup(),s.current=null,a([]),l(!1));return()=>{s.current&&s.current.cleanup()}},[n]),c.useEffect(()=>{localStorage.setItem("theme",r?"dark":"light")},[r]);const[h,d]=c.useState(0);c.useEffect(()=>{const u=()=>{d(window.scrollY)};return window.addEventListener("scroll",u,{passive:!0}),()=>window.removeEventListener("scroll",u)},[]),c.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(u=>{console.log("SW registered:",u)}).catch(u=>{console.log("SW registration failed:",u)})},[]);const x=(u,p,f)=>{const y={id:Date.now().toString(),name:u,shortName:p.trim()||void 0,leaves:0,maxLeaves:f},O=[...i,y];a(O),s.current&&s.current.saveCourses(O)},w=(u,p)=>{const f=i.map(y=>y.id===u?{...y,leaves:Math.max(0,y.leaves+p)}:y);a(f),s.current&&s.current.saveCourses(f)},m=u=>{const p=i.filter(f=>f.id!==u);a(p),s.current&&s.current.saveCourses(p)};if(t)return e.jsx("div",{className:`min-h-screen flex items-center justify-center ${r?"bg-gradient-to-br from-gray-900 via-purple-900 to-indigo-900":"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:r?"text-white":"text-gray-900",children:"Loading..."})]})});if(!n)return e.jsx(je,{isDark:r});const b=n.displayName?.split(" ")[0]||"there",W=b.charAt(0).toUpperCase()+b.slice(1).toLowerCase(),k=Math.min(h/100,1),U=1-Math.pow(1-k,3),$=Math.max(0,1-U),G=Math.min(h/3,20);return e.jsx("div",{className:`min-h-screen transition-colors ${r?"bg-gradient-to-br from-gray-900 to-gray-800":"bg-gradient-to-br from-blue-50 to-indigo-100"}`,children:e.jsxs("div",{className:"max-w-2xl mx-auto min-h-screen flex flex-col",children:[e.jsx("header",{className:"sticky top-0 z-10 backdrop-blur-lg bg-white/10 px-4 py-4 transition-all duration-300",style:{opacity:$,transform:`translateY(-${G}px)`,pointerEvents:$<.1?"none":"auto"},children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:`text-xl whitespace-nowrap ${r?"text-white":"text-gray-800"}`,children:e.jsx("b",{children:"Margin"})}),e.jsx("p",{className:`text-sm whitespace-nowrap ${r?"text-gray-400":"text-gray-600"}`,children:"Maximise your Leaves"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>g(!r),className:`p-3 rounded-full transition-all active:scale-95 ${r?"bg-gray-700 hover:bg-gray-600 text-yellow-400":"bg-white hover:bg-gray-100 text-gray-700"} shadow-md`,children:r?e.jsx(ee,{size:20}):e.jsx(te,{size:20})}),e.jsx(Ne,{isDark:r})]})]})}),e.jsxs("main",{className:"flex-1 p-4 space-y-4 pb-6",children:[e.jsx(ye,{isDark:r}),e.jsx("div",{className:"mb-2",children:e.jsxs("h2",{className:`text-2xl font-black ${r?"text-white":"text-gray-900"}`,style:{fontWeight:500,textShadow:r?"0 0 1px rgba(255,255,255,0.5)":"0 0 1px rgba(0,0,0,0.3)"},children:["Hi, ",W,"!"]})}),e.jsx(fe,{courses:i,isDark:r}),e.jsx(pe,{onAddCourse:x,isDark:r}),e.jsx(be,{courses:i,onUpdateLeaves:w,onDeleteCourse:m,isDark:r})]})]})})}function Oe(){return e.jsx(ve,{children:e.jsx($e,{})})}me.createRoot(document.getElementById("root")).render(e.jsx(Oe,{}));
